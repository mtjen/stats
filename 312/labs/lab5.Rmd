---
title: "Stat 312 R Lab 5"
author: "Max Tjen"
date: "7/28"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1:

A random sample of 21 energy bars of a particular brand is selected from a number of different stores. The labels on the bars claim that on the average such energy bars contain 20 grams of protein. Laboratory tests shows that the actual grams of protein for this 21 samples are:  
20.70,	27.46,	22.15,	19.85,	21.29,	24.75, 20.75,	22.91, 25.34,	20.33, 21.54, 21.08, 22.14, 19.56,	21.10, 18.04,	24.12, 	19.95,  19.72, 	18.28,	16.26.

### a) (2 points)
Construct a quantile-quantile plot for the data to check if the protein contents on such energy bars can be modelled by a normal distribution.  

```{r}
sample = c(20.70,	27.46, 22.15, 19.85, 21.29, 24.75, 20.75, 22.91, 25.34, 20.33, 21.54, 21.08, 
           22.14, 19.56, 21.10, 18.04, 24.12, 19.95, 19.72, 18.28, 16.26)

qqnorm(sample)
qqline(sample)
```
Ans: The data for the most part can be modeled by a normal distribution as most of the points in the middle are along the line  

### b) (4 points)
Check the normality assumption about the population distribution using a formal hypothesis testing method. Use a significance level of $\alpha = 0.05$. You can the Shapiro-Wilk test for normality. Clearly state the null hypothesis and the alternative hypothesis. Do you have the same conclusion as in a)?  

```{r}
shapiro.test(sample)
```

Ans:  
Hypotheses:  
$H_0$ = The population is normal  
$H_1$ = The population is not normal  
Yes we get the same conclusion as we wouldn't reject the null hypothesis becasue the p-value is relatively big, which means that the population is normal  


### c) (6 points)
Test an hypothesis against the claim that the average protein content on such energy bars is equal to 20 grams. Use a significance level of $\alpha = 0.05$. Clearly state the null hypothesis and the alternative hypothesis and your conclusion in the context. Also report the p-value.  

```{r}
t.test(sample, mu = 20, alternative="two.sided", conf.level=0.95)
```

Ans:  
Hypotheses:  
$H_0$ = The average protein content on the energy bars is 20 grams  
$H_1$ = The average protein content on the energy bars is not 20 grams  
With the p value being 0.03 and close to 0, we can reject the null hypothesis and accept the alternative, meaning that the average protein content on these energy bars is significantly different than 20 grams of protein  
